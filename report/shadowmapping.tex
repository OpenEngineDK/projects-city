
\section{Shadow Mapping}

Shadow Mapping is a image-based shadowing technique.

The technique was first described in \cite{lance78}.

In 1985, Pixar used shadow mapping to create the video Luxo Jr. This
non real-time video was extremely impressive at its time.
\todoPtx{stuff}
In 2001 at Macworld Expo Japan, Steve Jobs shows a real-time version
using OpenGL.

\todoPtx{more bla.bla}

Shadow Mapping is a two-pass algorithm. The first step is to create
the ``Shadow Map'' which describes the scene from the light sources
point of view. In the second pass this map will be used to add shadows
while rendering the scene as seen by the camera.


\subsection{The light source}

To create the shadow map, the light sources need a bit more
information than usually. Regular lights in OpenGL have properties
that describes the amount of light emitted, and the placement of the
light source. This is not enough, as we need to create a project to be
able to render the scene from the light. \todoPtx{omskriv?}

Because of this, a light sources is more like a camera, which gives us
a nice abstraction. \todoPtx{complete me}


\subsection{Creating the Shadow map}

The first part of the algorithm is to create the shadow map. This is
done by rendering the scene using the light source as the camera, and
extracting the depth buffer.

\todoPtx{Husk at implementere det} The only interesting information is
the depth, so the rendering can be speed up be disabling textures,
lighting, colors and more. Its also convenient to disable front faces
to avoid self-shadowing. % bla bla?


\subsection{Rendering the Scene}
\todoPtx{Beskriv step 2}

The next step is to render the scene with shadows. For each fragment
in the finished scene, we must decide if it is in a shadow or
not. This is done by comparing the depth of the fragment with depth in
the shadow map.

\subsubsection{Lookup in the shadow map}

Before we can compare anything, we need to find the corresponding
point in the shadow map. To calculate this, we need create a
projection matrix that converts model coordinates into projective
texture coordinates.

\subsubsection{Comparing Depth}

Bias matrix

\begin{align*}
  B = \begin{bmatrix}
    0.5 & 0   & 0   & 0.5 \\
    0   & 0.5 & 0   & 0.5 \\
    0   & 0   & 0.5 & 0.5 \\
    0   & 0   & 0   & 1   \\
  \end{bmatrix}
\end{align*}


\subsection{Implementation}

\subsubsection{Lighting}

When we add vertex and fragment shaders to our pipeline, we loose all
the fixed functions, so we need to implement our own lighting.

\subsection{Limitations}



Shadow mapping is a technique for adding shadows in projection based \todoPtx{fixy?}
3D rendering. As such, it is limited by what is possible with projections.

One of these is that we cant have a field of view larger than 180
degrees\todoPtx{reference}. Therefor shadow mapping wont work with point
light sources.

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "master"
%%% End: 
